var Q = require('q');

module.exports = function (opts) {
  var app = opts.libs.app
    , libs = opts.libs
    ;


  /**
   * Get all files/folders in a directory
   */
  // app.get('/api/filesystem/lister/:location', function (req, res) {
  //   libs.filelister.listAll(req.params.location).then(function(results) {
  //     res.send(results);
  //   });
  // });

  app.get('/api/filesystem/lister/server', function (req, res) {
    libs.filelister.listAll('baseDir').then(function(results) {
      res.send(results);
    });
  });

  app.get('/api/filesystem/lister/public', function (req, res) {
    libs.filelister.listAll('publicDir').then(function(results) {
      res.send(results);
    });
  });

  /**
   * [ description]
   * @param  {[type]} req [description]
   * @param  {[type]} res [description]
   * @return {[type]}     [description]
   */

  app.get('/api/filesystem/lister/:type/views/:file', function (req, res) {
    libs.filelister.getFile( opts.baseDir + '/views/' + req.params.file, req.params.type ).then(function(results) {
      res.send(results);
    });
  });

  /**
   * [ description]
   * @param  {[type]} req [description]
   * @param  {[type]} res [description]
   * @return {[type]}     [description]
   */
  app.get('/api/filesystem/lister/individual/:folder', function (req, res) {
    libs.filelister.getFolderContents(req.params.location).then(function(results) {
      res.send(results);
    });
  });

};